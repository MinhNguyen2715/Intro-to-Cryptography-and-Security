<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Many-Time Pad Attack – Explanation</title>
<style>
  :root {
    --fg: #1f2937;
    --bg: #ffffff;
    --muted: #6b7280;
    --accent: #2563eb;
    --border: #e5e7eb;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }
  html, body { margin:0; padding:0; background: var(--bg); color: var(--fg); }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; line-height: 1.6; }
  .container { max-width: 860px; padding: 32px 20px 56px; margin: 0 auto; }
  h1 { font-size: 1.9rem; margin: 0 0 0.75rem; }
  h2 { font-size: 1.35rem; margin-top: 2rem; margin-bottom: 0.5rem; }
  p { margin: 0.6rem 0; }
  .center { text-align: center; }
  .muted { color: var(--muted); }
  code, pre { font-family: var(--mono); }
  pre { background: #0b1020; color: #e6edf3; padding: 14px 16px; overflow-x: auto; border-radius: 8px; }
  kbd { background: #f3f4f6; border: 1px solid var(--border); border-bottom-width: 2px; border-radius: 6px; padding: 0 6px; font-family: var(--mono); }
  table { border-collapse: collapse; width: 100%; margin: 12px 0 18px; }
  th, td { border: 1px solid var(--border); padding: 8px 10px; text-align: center; }
  thead th { background: #f8fafc; font-weight: 600; }
  .table-wrap { display: flex; justify-content: center; }
  .table-narrow { width: auto; min-width: 60%; }
  .caption { font-size: 0.95rem; text-align: center; margin-top: -2px; color: var(--muted); }
  hr { border: none; border-top: 1px solid var(--border); margin: 24px 0; }
  .note { background: #f8fafc; border: 1px dashed var(--border); padding: 10px 12px; border-radius: 8px; }
  .callout { border-left: 4px solid var(--accent); background: #f6f9ff; padding: 10px 12px; border-radius: 6px; }
  .math { font-family: var(--mono); background: #f9fafb; padding: 2px 6px; border-radius: 6px; }
</style>
</head>
<body>
  <div class="container">
    <h1>Explanation of Many Time Pad attack</h1>

    <h2 id="vulnerability">The many time pad vulnerability</h2>
    <p>Suppose we have 2 ciphertexts: <span class="math">Y<sub>1</sub></span> and <span class="math">Y<sub>2</sub></span>:</p>
    <p class="center">
      <span class="math">Y<sub>1</sub> = X<sub>1</sub> ⊕ K</span><br/>
      <span class="math">Y<sub>2</sub> = X<sub>2</sub> ⊕ K</span>
    </p>
    <p>If we apply the XOR operation to the 2 ciphertexts:</p>
    <p class="center">
      <span class="math">Y<sub>1</sub> ⊕ Y<sub>2</sub> = X<sub>1</sub> ⊕ K ⊕ X<sub>2</sub> ⊕ K = X<sub>1</sub> ⊕ X<sub>2</sub></span>
    </p>

    <p>Assume that plaintexts are made up of only letter (both lowercase and uppercase) and space, consider what happens when 2 charecters from plaintext are XORed together:</p>

    <div class="table-wrap">
      <table class="table-narrow">
        <thead>
          <tr>
            <th>⊕</th>
            <th>A–Z (65–90)</th>
            <th>a–z (97–122)</th>
            <th>Space (32)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>A–Z (65–90)</th>
            <td>≤32</td>
            <td>≤64</td>
            <td>≥65</td>
          </tr>
          <tr>
            <th>a–z (97–122)</th>
            <td>≤64</td>
            <td>≤32</td>
            <td>≥65</td>
          </tr>
          <tr>
            <th>Space (32)</th>
            <td>≥65</td>
            <td>≥65</td>
            <td>0</td>
          </tr>
        </tbody>
      </table>
    </div>
    <p class="caption"><em>Using ASCII encoding in decimal</em></p>

    <p>From the table, we can see that, when XORing a space with any of the upper/lowercase letters, a number ≥65 is obtained; that is the only case when this happens.</p>

    <h2>Here an example: suppose we have 3 plaintexts:</h2>
    <pre><code>Happy birthday
Crypto is fun
Euler algorithm</code></pre>

    <p>and they have encrypted with the same key by OTP. Split the message into column for demostrate:</p>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th></th>
            <th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>X<sub>1</sub></th>
            <td>H</td><td>a</td><td>p</td><td>p</td><td>y</td><td> </td><td>b</td><td>i</td><td>r</td><td>t</td><td>h</td><td>d</td><td>a</td><td>y</td><td></td>
          </tr>
          <tr>
            <th>X<sub>2</sub></th>
            <td>C</td><td>r</td><td>y</td><td>p</td><td>t</td><td>o</td><td> </td><td>i</td><td>s</td><td> </td><td>f</td><td>u</td><td>n</td><td></td><td></td>
          </tr>
          <tr>
            <th>X<sub>3</sub></th>
            <td>E</td><td>u</td><td>l</td><td>e</td><td>r</td><td> </td><td>a</td><td>l</td><td>g</td><td>o</td><td>r</td><td>i</td><td>t</td><td>h</td><td>m</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p>Consider 10<sup>th</sup> column:</p>

    <p class="center">
      <span class="math">X<sub>1</sub>[9] ⊕ X<sub>2</sub>[9] = 84</span><br/>
      <span class="math">X<sub>2</sub>[9] ⊕ X<sub>3</sub>[9] = 79</span>
    </p>

    <p>We can certainly comfirm that <span class="math">X<sub>2</sub>[9]</span> is a space, then we can recover one char of the key itself:</p>

    <p class="center">
      <span class="math">K[6] = X<sub>0</sub>[6] ⊕ Y<sub>0</sub>[6]</span>
    </p>

    <p>With enough ciphertexts, all encode using the same key by OTP, we can decrypt this given that there are many spaces among those. Even if we cannot get the whole key, with the partial decryption, we can solve the rest by hand.</p>

    <h2>In conclusion, the idea to attack Many Time Pad using the same key is:</h2>
    <p class="center">
      <span class="math">If X<sub>i</sub>[k] ⊕ X<sub>j</sub>[k] ≥ 65 ∀ i≠j<br/>
      ⇒ X<sub>i</sub>[k] or X<sub>j</sub>[k] is a space</span>
    </p>
  </div>
</body>
</html>
